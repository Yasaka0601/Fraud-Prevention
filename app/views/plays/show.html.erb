<h1><%= @course.name %></h1>

<p><%= @index %> / 5問 </p>

  <h2> 第 <%= @index %> 問 </h2>
  <p><%= @quiz.sentence %></p>

<%= form_with url: answer_course_play_path(@course, @index), method: :post, local: true, data: { turbo: false } do |form| %>
  <% if @multiple_answer %>
    <% @choices.each do |choice| %>
      <div>
        <input
          type="checkbox"
          name="selected_choice_ids[]"
          id="choice_<%= choice.id %>"
          value="<%= choice.id %>"
          <%= "checked" if @selected_choice_ids&.include?(choice.id) %>
        >
        <label for="choice_<%= choice.id %>">
          <%= choice.text %>
        </label>
      </div>
    <% end %>
  <% else %>
    <% @choices.each do |choice| %>
      <div>
        <input
          type  = "radio"
          name  = "selected_choice"
          id    = "choice_<%= choice.id %>"
          value = "<%= choice.id %>"
          <%= "checked" if choice.id.to_s == @selected_choice_id.to_s %>
        >
        <label for="choice_<%= choice.id %>">
          <%= choice.text %>
        </label>
      </div>
    <% end %>
  <% end %>

  <div>
      <%= form.submit "回答する" %>
  </div>

<% end %>

<% unless @is_correct.nil? %>
  <hr>

  <% if @is_correct %>
    <p>✅正解✅</p>
  <% else %>
    <p>❌不正解❌</p>
  <% end %>

  <% if @multi_correct_choices.present? %>
    <p>正解：</p>
    <ul>
      <% @multi_correct_choices.each do |correct| %>
        <li><%= correct.text %></li>
      <% end %>
    </ul>
  <% end %>

  <% if @quiz.explanation.present? %>
    <p>解説： <%= @quiz.explanation %></p>
  <% end %>

  <p>
     <% if @index == 5 %>
      <%= "結果発表" %>
    <% else %>
      <%= link_to "次の問題へ進む", course_play_path(@course, @index + 1) %>
    <% end %>
  </p>
<% end %>